# نظام الملف الطبي الشامل - Medical Records System

## نظرة عامة

تم إنشاء نظام شامل لإدارة الملفات الطبية للمرضى مع دعم كامل لجميع أنواع المستخدمين (Admin, Doctor, Reception, Insurance) وربط مع Slack للتواصل المباشر.

## المميزات الرئيسية

### 1. ملف طبي شامل للمريض
- **السجلات الطبية**: جميع أنواع السجلات (زيارات، تشخيصات، وصفات، نتائج مختبر، صور أشعة)
- **التشخيصات**: تتبع جميع التشخيصات مع الحالة (نشط، محلول، مزمن)
- **الوصفات الطبية**: إدارة كاملة للوصفات مع الجرعات والتكرار
- **نتائج المختبر**: تتبع جميع الفحوصات المخبرية
- **صور الأشعة**: إدارة نتائج التصوير الطبي
- **العلامات الحيوية**: تتبع العلامات الحيوية لكل زيارة

### 2. شاشة الاستقبال (Reception)
- **طابور المرضى**: إدارة كاملة لطابور الاستقبال
- **إحصائيات يومية**: عدد المرضى، الحالات، الإنجازات
- **تحديث الحالات**: تغيير حالة المريض (انتظار، قيد المعالجة، مكتمل)
- **استدعاء التالي**: زر لاستدعاء المريض التالي تلقائياً

### 3. شاشة الطبيب (Doctor)
- **مواعيد اليوم**: عرض جميع مواعيد اليوم
- **مرضاي**: قائمة بجميع المرضى المرتبطين بالطبيب
- **السجلات الطبية**: عرض جميع السجلات الطبية
- **الملف الطبي الكامل**: عرض شامل لملف المريض مع جميع التفاصيل
- **ربط Slack**: التواصل المباشر مع المرضى عبر Slack

### 4. شاشة التأمينات (Insurance)
- **إدارة المطالبات**: عرض وإدارة جميع مطالبات التأمين
- **حالات المطالبات**: (قيد المراجعة، موافق عليه، مرفوض، مدفوع)
- **حسابات مالية**: المبلغ الإجمالي، المغطى، مسؤولية المريض
- **فلترة متقدمة**: حسب الحالة، شركة التأمين، المريض

### 5. بروفايلات الأطباء
- **معلومات شاملة**: التخصص، الرخصة، سنوات الخبرة
- **التعليم والشهادات**: قائمة كاملة بالتعليم والشهادات
- **اللغات**: اللغات التي يتحدث بها الطبيب
- **عدد المرضى**: عدد المرضى المرتبطين بالطبيب
- **رسوم الاستشارة**: معلومات الرسوم

### 6. ربط Slack
- **محادثات منفصلة**: محادثة منفصلة لكل طبيب-مريض
- **مزامنة الرسائل**: مزامنة الرسائل مع قاعدة البيانات
- **إشعارات**: إشعارات عند رسائل جديدة

## جداول قاعدة البيانات

### الجداول الجديدة

1. **medical_records**: السجلات الطبية الشاملة
2. **diagnoses**: التشخيصات
3. **prescriptions**: الوصفات الطبية
4. **lab_results**: نتائج المختبر
5. **imaging_results**: نتائج التصوير
6. **vital_signs**: العلامات الحيوية
7. **doctor_profiles**: بروفايلات الأطباء
8. **doctor_patient_relationships**: علاقات الأطباء بالمرضى
9. **insurance_claims**: مطالبات التأمين
10. **reception_queue**: طابور الاستقبال
11. **slack_conversations**: محادثات Slack
12. **slack_messages**: رسائل Slack

### تحديثات الجداول الموجودة

- **patients**: إضافة حقول طبية (تاريخ الميلاد، الجنس، فصيلة الدم، الحساسيات، الأمراض المزمنة، معلومات الطوارئ، التأمين)
- **users**: إضافة أدوار جديدة (reception, insurance)

## API Endpoints

### Reception
- `GET /api/reception/queue` - الحصول على طابور اليوم
- `POST /api/reception/queue` - إضافة مريض للطابور
- `PUT /api/reception/queue/[id]` - تحديث حالة الطابور
- `DELETE /api/reception/queue/[id]` - حذف من الطابور

### Doctor
- `GET /api/doctor/appointments` - مواعيد اليوم
- `GET /api/doctor/patients` - مرضاي
- `GET /api/doctor/medical-records` - السجلات الطبية

### Insurance
- `GET /api/insurance/claims` - جميع المطالبات
- `POST /api/insurance/claims` - إنشاء مطالبة جديدة
- `PUT /api/insurance/claims/[id]` - تحديث حالة المطالبة

### Doctors Profiles
- `GET /api/doctors/profiles` - جميع البروفايلات
- `GET /api/doctors/profiles/[id]` - بروفايل واحد
- `POST /api/doctors/profiles` - إنشاء بروفايل
- `PUT /api/doctors/profiles/[id]` - تحديث بروفايل

### Patients Medical File
- `GET /api/patients/[id]/medical-file` - الملف الطبي الكامل

### Slack
- `GET /api/slack/conversations` - المحادثات
- `POST /api/slack/conversations` - إنشاء محادثة
- `GET /api/slack/messages` - الرسائل
- `POST /api/slack/messages` - إرسال رسالة

## الصفحات الجديدة

1. `/dashboard/reception` - شاشة الاستقبال
2. `/dashboard/doctor` - شاشة الطبيب
3. `/dashboard/insurance` - شاشة التأمينات
4. `/dashboard/doctors` - بروفايلات الأطباء

## Workflow لكل نوع مستخدم

### Admin
- الوصول الكامل لجميع الصفحات
- إدارة المستخدمين
- إدارة المحتوى
- إدارة قاعدة المعرفة

### Reception
- شاشة الاستقبال فقط
- إدارة طابور المرضى
- تحديث حالات المرضى

### Doctor
- شاشة الطبيب
- عرض مواعيد اليوم
- عرض مرضاي
- عرض السجلات الطبية
- الملف الطبي الكامل
- التواصل عبر Slack

### Insurance
- شاشة التأمينات فقط
- عرض وإدارة المطالبات
- الموافقة/الرفض على المطالبات

## الخطوات التالية

1. **ربط Slack API**: إكمال ربط Slack API الفعلي
2. **Authentication**: إضافة نظام المصادقة والصلاحيات
3. **Notifications**: إضافة نظام الإشعارات
4. **Reports**: إضافة التقارير والإحصائيات
5. **Mobile App**: تطبيق موبايل للمرضى والأطباء

## ملاحظات

- جميع الجداول محمية بـ Row Level Security (RLS)
- جميع API endpoints تستخدم `supabaseAdmin` للوصول الكامل
- النظام جاهز للتوسع وإضافة المزيد من المميزات

