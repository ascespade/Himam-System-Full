# โ๏ธ ุญู ููุงุฆู: ูุดู ุชูุนูู ุงูููุฑูููู

## ๐ด ุงููุดููุฉ ุงูุญุงููุฉ

```
"now its fail active"
```

**ุงูุณุจุจ**: ุนูุฏูุง ุชุญุงูู ุชูุนูู ุงูููุฑูููู ูู n8nุ n8n ูุญุงูู ุงูุชุญูู ูู webhook ูุน Meta ุชููุงุฆูุงู. ููู ูุฃู ุงูููุฑูููู ุบูุฑ Activeุ Render ูุนูุฏ HTML ุจุฏูุงู ูู plain text challengeุ ูุฐูู Meta ูุฑูุถ ุงูุชุญูู ูุงูุชูุนูู ููุดู.

## โ ุงูุญู ุงูููุงุฆู (3 ุทุฑู)

### ุงูุทุฑููุฉ 1: ุงุณุชุฎุฏุงู Test URL ููุชุญูู ุฃููุงู (ุงูุฃุณูู)

**โ๏ธ ูุฐู ุงูุทุฑููุฉ ุงูุฃุณูู ูุงูุฃูุซุฑ ููุซูููุฉ!**

1. **ูู Meta Developer Console:**
   - ุงุฐูุจ ุฅูู [Meta Developer Console](https://developers.facebook.com/)
   - ุงุฎุชุฑ WhatsApp App โ Configuration โ Webhooks
   - ูู **"ุนููุงู URL ุงูุงุณุชุฏุนุงุก" (Callback URL)**:
     - ุงุณุชุฎุฏู **Test URL**: `https://n8n-9q4d.onrender.com/webhook-test/whatsapp-webhook`
     - โ๏ธ **Test URL** ูุนูู ุญุชู ูู ูุงู ุงูููุฑูููู ุบูุฑ Active!
   - ูู **"ุชุญูู ูู ุงูุฑูุฒ" (Verify Token)**:
     - ุฃุฏุฎู: `my-secret-token`
   - ุงุถุบุท **"ุชุญูู ูุญูุธ" (Verify and Save)**
   - โ **ุงูุชุญูู ูุฌุจ ุฃู ููุฌุญ!**

2. **ุจุนุฏ ุงูุชุญููุ ูุนูู ุงูููุฑูููู ูู n8n:**
   - ุงุฐูุจ ุฅูู: `https://n8n-9q4d.onrender.com/workflow/YCZ3lqYrNxWylyg3`
   - ุงุถุบุท ุนูู **Toggle Switch** ูุชูุนููู
   - โ **ุงูุขู ูุฌุจ ุฃู ูุนูู!**

3. **ุจุนุฏ ุงูุชูุนููุ ุบููุฑ ุฅูู Production URL ูู Meta:**
   - ูู Meta Developer Console โ Webhooks
   - ุบููุฑ **Callback URL** ุฅูู: `https://n8n-9q4d.onrender.com/webhook/whatsapp-webhook`
   - ุงุถุบุท **"ุชุญูู ูุญูุธ"** ูุฑุฉ ุฃุฎุฑู
   - โ **ุงูุขู webhook ูุนูู ูู Production!**

### ุงูุทุฑููุฉ 2: ุชูุนูู ุงูููุฑูููู ุจุฏูู ุงูุชุญูู

**โ๏ธ ุงุณุชุฎุฏู ูุฐู ุงูุทุฑููุฉ ุฅุฐุง ูุงู webhook ูุญูู ูู Meta ุจุงููุนู!**

1. **ุชุญูู ูู webhook ูู Meta ุฃููุงู:**
   - ุงุฐูุจ ุฅูู Meta Developer Console
   - ุชุญูู ูู webhook (ุงุณุชุฎุฏู Test URL ุฃู Production URL)
   - ุชุฃูุฏ ูู ุฃู ุงูุชุญูู ูุฌุญ โ

2. **ูุนูู ุงูููุฑูููู ูู n8n:**
   - ุงุฐูุจ ุฅูู: `https://n8n-9q4d.onrender.com/workflow/YCZ3lqYrNxWylyg3`
   - ุงุถุบุท ุนูู **Toggle Switch** ูุชูุนููู
   - ุฅุฐุง ุธูุฑุช ุฑุณุงูุฉ ุฎุทุฃ ูู Meta:
     - **ุชุฌุงูู ุงูุฎุทุฃ** (ุฅุฐุง ูุงู webhook ูุญูู ูู Meta ุจุงููุนู)
     - ุงุถุบุท **"Activate Anyway"** ุฃู **"Skip Verification"**
     - ุฃู ุฃุนุฏ ุงููุญุงููุฉ ุจุนุฏ ุจุถุน ุซูุงู

### ุงูุทุฑููุฉ 3: ุชูุนูู ุงูููุฑูููู ูุฏููุงู ูู API

**โ๏ธ ูุฐู ุงูุทุฑููุฉ ูุชูุฏูุฉ - ุงุณุชุฎุฏููุง ููุท ุฅุฐุง ูุดูุช ุงูุทุฑููุชุงู ุงูุณุงุจูุชุงู!**

```bash
# ุงุญุตู ุนูู API key ูู n8n Settings โ API
# ุซู ุงุณุชุฎุฏู curl:

curl -X POST "https://n8n-9q4d.onrender.com/api/v1/workflows/YCZ3lqYrNxWylyg3/activate" \
  -H "X-N8N-API-KEY: YOUR_API_KEY" \
  -H "Content-Type: application/json"
```

## ๐ Checklist ุงูููุงุฆู

**ูุจู ูุญุงููุฉ ุชูุนูู ุงูููุฑูููู:**

- [ ] โ ุชู ุงูุชุญูู ูู webhook ูู Meta (ุงุณุชุฎุฏู Test URL)
- [ ] โ Webhook URL ุตุญูุญ ูู Meta
- [ ] โ Verify Token ูุชุทุงุจู: `my-secret-token`
- [ ] โ ุงูููุฑูููู ูุญููุธ ูู n8n

**ุจุนุฏ ุชูุนูู ุงูููุฑูููู:**

- [ ] โ ุงูููุฑูููู **Active** ูู n8n
- [ ] โ Webhook URL ูู Meta ูู Production URL
- [ ] โ ุฌุฑุจ curl - ูุฌุจ ุฃู ูุนูุฏ plain text challenge

## ๐งช ุงุฎุชุจุงุฑ ุดุงูู

### ุงุฎุชุจุงุฑ 1: Test URL (ูุฌุจ ุฃู ูุนูู ุญุชู ูู ูุงู ุงูููุฑูููู ุบูุฑ Active)

```bash
curl "https://n8n-9q4d.onrender.com/webhook-test/whatsapp-webhook?hub.mode=subscribe&hub.verify_token=my-secret-token&hub.challenge=test123"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**: `test123` (plain text) โ

### ุงุฎุชุจุงุฑ 2: Production URL (ูุฌุจ ุฃู ูุนูู ููุท ุฅุฐุง ูุงู ุงูููุฑูููู Active)

```bash
curl "https://n8n-9q4d.onrender.com/webhook/whatsapp-webhook?hub.mode=subscribe&hub.verify_token=my-secret-token&hub.challenge=test123"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**:
- ุฅุฐุง ุงูููุฑูููู **ุบูุฑ Active**: HTML โ
- ุฅุฐุง ุงูููุฑูููู **Active**: `test123` (plain text) โ

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **Test URL vs Production URL**:
   - **Test URL**: `https://n8n-9q4d.onrender.com/webhook-test/whatsapp-webhook`
     - ูุนูู ุญุชู ูู ูุงู ุงูููุฑูููู ุบูุฑ Active โ
     - ุงุณุชุฎุฏูู ููุชุญูู ุฃููุงู
   - **Production URL**: `https://n8n-9q4d.onrender.com/webhook/whatsapp-webhook`
     - ูุนูู ููุท ุฅุฐุง ูุงู ุงูููุฑูููู Active โ
     - ุงุณุชุฎุฏูู ุจุนุฏ ุงูุชูุนูู

2. **ุงูุชุญูู ูู Meta ุฃููุงู**: ูุฌุจ ุงูุชุญูู ูู webhook ูู Meta **ูุจู** ูุญุงููุฉ ุชูุนูู ุงูููุฑูููู ูู n8n.

3. **ุชุฌุงูู ุฎุทุฃ ุงูุชุญูู ุนูุฏ ุงูุชูุนูู**: ุฅุฐุง ุธูุฑ ุฎุทุฃ ูู Meta ุนูุฏ ุงูุชูุนููุ ููู webhook ูุญูู ูู Meta ุจุงููุนูุ ููููู ุชุฌุงูู ุงูุฎุทุฃ ูุชูุนูู ุงูููุฑูููู.

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "response does not match challenge" ุนูุฏ ุงูุชูุนูู

**ุงูุณุจุจ**: ุงูููุฑูููู ุบูุฑ Activeุ ูุฐูู Meta ูุญุตู ุนูู HTML.

**ุงูุญู**:
1. ุงุณุชุฎุฏู **Test URL** ููุชุญูู ูู Meta ุฃููุงู
2. ูุนูู ุงูููุฑูููู ูู n8n
3. ุบููุฑ ุฅูู **Production URL** ูู Meta ุจุนุฏ ุงูุชูุนูู

### ุงููุดููุฉ: curl ูุนูุฏ HTML ุจุนุฏ ุงูุชูุนูู

**ุงูุณุจุจ**: ุงูููุฑูููู ุบูุฑ Active ุฃู WAF ูุนูุฏ HTML.

**ุงูุญู**:
1. ุชุฃูุฏ ูู ุฃู ุงูููุฑูููู Active
2. ุชุญูู ูู Render Logs - ูู ุชุตู ุงูุทูุจุงุช ุฅูู n8nุ
3. ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ูุฏ ุชููู ุงููุดููุฉ ูู WAF - ุฑุงุฌุน `docs/WEBHOOK_VERIFICATION_TROUBLESHOOTING.md`

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2025-12-06

**ุงูุฎูุงุตุฉ**: 
1. ุงุณุชุฎุฏู **Test URL** ููุชุญูู ูู Meta ุฃููุงู โ
2. ูุนูู ุงูููุฑูููู ูู n8n โ
3. ุบููุฑ ุฅูู **Production URL** ูู Meta ุจุนุฏ ุงูุชูุนูู โ

**ุงูุทุฑููุฉ ุงูููุตู ุจูุง**: ุงูุทุฑููุฉ 1 (ุงุณุชุฎุฏุงู Test URL ููุชุญูู ุฃููุงู)

